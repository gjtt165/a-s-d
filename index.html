<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bitahub è¿ç»´å¹³å° </title>
<style>
  :root{
    --primary:#0066ff;--bg:#f5f7fa;--card:#fff;--muted:#666;--border:#e9edf2;
    --radius:8px;--shadow:0 1px 4px rgba(0,0,0,.08);
    --green:#22c55e;--yellow:#f59e0b;--blue:#3b82f6;--red:#ef4444;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);font:14px/1.6,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial}
  .header{background:var(--primary);color:#fff;padding:12px 20px;font-size:18px}
  .layout{display:flex;min-height:100dvh}
  .sidebar{width:240px;background:#f8f9fb;border-right:1px solid var(--border);padding:14px}
  .side-title{color:#999;font-size:12px;margin:6px 10px}
  .menu a{display:flex;gap:8px;align-items:center;color:#334;text-decoration:none;padding:9px 12px;border-radius:6px;margin:4px 0}
  .menu a.active{background:#e6f0ff;color:var(--primary);font-weight:600}
  .menu .dot{width:8px;height:8px;border-radius:50%;background:var(--primary)}
  .main{flex:1;padding:18px}

  .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
  .toolbar{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:8px;flex-wrap:wrap}
  .toolbar-left,.toolbar-right{display:flex;align-items:center;gap:8px}
  .input{border:1px solid var(--border);border-radius:6px;padding:8px 10px;min-width:260px;background:#fff}
  table{width:100%;border-collapse:collapse;margin-top:8px}
  th,td{border-bottom:1px solid var(--border);padding:10px;text-align:left}
  th{background:#fafbfc}
  .link{color:var(--primary);cursor:pointer}
  .note{border:1px dashed var(--border);padding:6px 8px;border-radius:6px;color:#596}

  /* æŒ‰é’®ä¸å›¾æ ‡ */
  .btn{border:0;border-radius:6px;background:var(--primary);color:#fff;padding:8px 14px;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
  .btn:hover{filter:brightness(.96)}
  .btn.gray{background:#eef2f6;color:#223}
  .btn.ghost{background:transparent;color:var(--primary);border:1px solid var(--border)}
  .btn .icon-plus svg path{fill:#fff;stroke:#fff}
  .btn .icon-left svg path{stroke:#222}

  /* çŠ¶æ€å¾½ç« ï¼ˆå±•ç¤ºç”¨ï¼‰ */
  .badge{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:999px;font-weight:600}
  .b-enabled{color:var(--green);background:rgba(34,197,94,.12)}      /* ğŸŸ¢ å¯ç”¨ä¸­ */
  .b-draft{color:var(--yellow);background:rgba(245,158,11,.16)}      /* ğŸŸ¡ è‰ç¨¿ */
  .b-publishing{color:var(--blue);background:rgba(59,130,246,.16)}   /* ğŸ”µ å‘å¸ƒä¸­ */
  .b-failed{color:var(--red);background:rgba(239,68,68,.14)}          /* ğŸ”´ å‘å¸ƒå¤±è´¥ */

  /* é¡µé¢åˆ‡æ¢ */
  .page{display:none}
  .page.active{display:block}

  /* å­—å…¸å…ƒä¿¡æ¯ç¼–è¾‘åŒº */
  .meta-form{display:grid;grid-template-columns:160px 1fr;gap:10px 12px;margin:6px 0 14px}
  .meta-form label{color:#555;align-self:center}
  .meta-form .row{display:contents}
  .meta-actions{display:flex;gap:8px;margin-top:6px}
  .tip-mini{color:#8a8f98;font-size:12px}

  /* æ¨¡æ€æ¡† */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;place-items:center;padding:16px;z-index:20}
  .modal.show{display:grid}
  .dialog{background:#fff;border-radius:10px;min-width:360px;max-width:560px;border:1px solid var(--border);box-shadow:0 10px 30px rgba(0,0,0,.2)}
  .dialog header{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:600}
  .dialog main{padding:14px 16px;color:#334}
  .dialog footer{padding:12px 16px;border-top:1px solid var(--border);display:flex;gap:8px;justify-content:flex-end}
</style>
</head>
<body>
  <div class="header">äº‘ç«¯èµ„æºç®¡ç†ç³»ç»Ÿ Â· å­—å…¸ç®¡ç†åŸå‹</div>

  <div class="layout">
    <!-- å·¦ä¾§å¯¼èˆª -->
    <aside class="sidebar">
      <div class="side-title">å¯¼èˆª</div>
      <nav class="menu">
        <a><span class="dot"></span>ä¸šåŠ¡ç³»ç»Ÿç®¡ç†</a>
        <a><span class="dot"></span>é›†ç¾¤ç®¡ç†</a>
        <a><span class="dot"></span>ä»»åŠ¡ç®¡ç†</a>
        <a class="active"><span class="dot"></span>å­—å…¸ç®¡ç†</a>
        <a><span class="dot"></span>å¹³å°é•œåƒ</a>
        <a><span class="dot"></span>ç›‘æ§å‘Šè­¦</a>
        <a><span class="dot"></span>APIé…ç½®</a>
      </nav>
    </aside>

    <!-- ä¸»å†…å®¹ -->
    <main class="main">
      <!-- å­—å…¸åˆ—è¡¨é¡µ -->
      <section id="page-list" class="page active">
        <div class="card">
          <div class="toolbar">
            <div class="toolbar-left">
              <button class="btn" id="btn-create">
                <span class="icon-plus">
                  <svg viewBox="0 0 16 16" width="16" height="16"><path d="M8 3v10M3 8h10" stroke="#fff" stroke-width="2" stroke-linecap="round" fill="#fff"/></svg>
                </span>
                åˆ›å»ºå­—å…¸
              </button>
              <input class="input" placeholder="æœç´¢ï¼šåç§°/ç¼–ç " />
            </div>
            <div class="toolbar-right">
              <span class="note">çŠ¶æ€ä»…å±•ç¤ºï¼šğŸŸ¢å¯ç”¨ä¸­ / ğŸŸ¡è‰ç¨¿ / ğŸ”µå‘å¸ƒä¸­ / ğŸ”´å‘å¸ƒå¤±è´¥</span>
            </div>
          </div>

          <table id="dict-table">
            <thead>
              <tr><th>å­—å…¸ç¼–ç </th><th>åç§°</th><th>æè¿°</th><th>åˆ›å»ºæ—¶é—´</th><th>çŠ¶æ€</th><th style="width:220px">æ“ä½œ</th></tr>
            </thead>
            <tbody>
              <!-- JS æ¸²æŸ“ -->
            </tbody>
          </table>
        </div>
      </section>

      <!-- å­—å…¸é¡¹ç®¡ç†é¡µ -->
      <section id="page-item" class="page">
        <!-- é¡¶éƒ¨å·¥å…·æ ï¼šè¿”å› + æ–°å¢é¡¹ -->
        <div class="card" style="margin-bottom:12px">
          <div class="toolbar">
            <div class="toolbar-left">
              <button class="btn gray" id="btn-back">
                <span class="icon-left">
                  <svg viewBox="0 0 16 16" width="16" height="16"><path d="M9.5 3L4.5 8l5 5" fill="none" stroke="#222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </span>
                è¿”å›
              </button>
            </div>
            <div class="toolbar-right">
              <button class="btn" id="btn-add-item">
                <span class="icon-plus">
                  <svg viewBox="0 0 16 16" width="16" height="16"><path d="M8 3v10M3 8h10" stroke="#fff" stroke-width="2" stroke-linecap="round" fill="#fff"/></svg>
                </span>
                æ–°å¢å­—å…¸é¡¹
              </button>
            </div>
          </div>

          <!-- å­—å…¸å…ƒä¿¡æ¯ç¼–è¾‘åŒº -->
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
            <div class="tip-mini">å¯ç¼–è¾‘å­—å…¸çš„åŸºç¡€ä¿¡æ¯ï¼Œä¿å­˜ååŒæ­¥åˆ°åˆ—è¡¨ä¸æ ‡é¢˜</div>
            <div class="meta-actions">
              <button class="btn" id="btn-save-dict">
                <svg viewBox="0 0 16 16" width="16" height="16" style="margin-right:6px">
                  <path d="M3 8l3 3 7-7" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                </svg>ä¿å­˜
              </button>
            </div>
          </div>
          <div class="meta-form">
            <div class="row"><label for="edit-code">å­—å…¸ç¼–ç </label><input id="edit-code" class="input" placeholder="å¦‚ï¼šannotation_type"></div>
            <div class="row"><label for="edit-name">åç§°</label><input id="edit-name" class="input" placeholder="å¦‚ï¼šæ ‡æ³¨ç±»å‹"></div>
            <div class="row"><label for="edit-desc">æè¿°</label><input id="edit-desc" class="input" placeholder="å¦‚ï¼šç”¨äºæ ‡æ³¨åŠŸèƒ½çš„ç±»å‹é…ç½®"></div>
          </div>
        </div>

        <!-- å­—å…¸é¡¹è¡¨æ ¼ -->
        <div class="card">
          <h3 style="margin:6px 2px 10px" id="dict-title">å­—å…¸é¡¹ç®¡ç† Â· ï¼ˆæœªè®¾ç½®ç¼–ç ï¼‰</h3>
          <table>
            <thead><tr><th>æ’åº</th><th>Label</th><th>Value</th><th>çŠ¶æ€</th><th>å¤‡æ³¨</th><th>æ“ä½œ</th></tr></thead>
            <tbody>
              <tr><td>1</td><td>æ–‡å­—</td><td>text</td><td>å¯ç”¨</td><td>é»˜è®¤ç±»å‹</td><td><span class="link" data-open="del">åˆ é™¤</span></td></tr>
              <tr><td>2</td><td>å›¾ç‰‡</td><td>image</td><td>å¯ç”¨</td><td>2024æ–°å¢</td><td><span class="link" data-open="del">åˆ é™¤</span></td></tr>
              <tr><td>3</td><td>éŸ³é¢‘</td><td>audio</td><td>å¯ç”¨</td><td>è¿ç»´æ–°å¢</td><td><span class="link" data-open="del">åˆ é™¤</span></td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>
  </div>

  <!-- å¼¹çª—ï¼šæŸ¥çœ‹æ—¥å¿— -->
  <div id="modal-log" class="modal" aria-hidden="true">
    <div class="dialog" role="dialog" aria-modal="true">
      <header>æ“ä½œæ—¥å¿—</header>
      <main id="log-content">
        <div>2025-10-15 åˆ›å»ºå­—å…¸ <b>annotation_type</b></div>
        <div>2025-10-16 æ–°å¢é¡¹ <b>audio</b></div>
      </main>
      <footer><button class="btn gray" data-close="log">å…³é—­</button></footer>
    </div>
  </div>

  <!-- å¼¹çª—ï¼šåˆ é™¤ç¡®è®¤ -->
  <div id="modal-del" class="modal" aria-hidden="true">
    <div class="dialog" role="dialog" aria-modal="true">
      <header>ç¡®è®¤åˆ é™¤</header>
      <main>æ­¤æ“ä½œä¸å¯æ¢å¤ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ</main>
      <footer>
        <button class="btn gray" data-close="del">å–æ¶ˆ</button>
        <button class="btn" id="confirm-delete">ç¡®è®¤åˆ é™¤</button>
      </footer>
    </div>
  </div>

  <!-- å¼¹çª—ï¼šæ–°å¢å­—å…¸é¡¹ï¼ˆæ¼”ç¤ºï¼‰ -->
  <div id="modal-add" class="modal" aria-hidden="true">
    <div class="dialog" role="dialog" aria-modal="true">
      <header>æ–°å¢å­—å…¸é¡¹</header>
      <main>
        <div style="display:grid;gap:10px">
          <label>Labelï¼š<input class="input" placeholder="å¦‚ï¼šéŸ³é¢‘"></label>
          <label>Valueï¼š<input class="input" placeholder="å¦‚ï¼šaudio"></label>
          <label>å¤‡æ³¨ï¼š<input class="input" placeholder="å¯é€‰"></label>
        </div>
      </main>
      <footer>
        <button class="btn gray" data-close="add">å–æ¶ˆ</button>
        <button class="btn" data-close="add">ä¿å­˜</button>
      </footer>
    </div>
  </div>

<script>
/* â€”â€” çŠ¶æ€ä½“ç³»ï¼ˆå±•ç¤ºç”¨ï¼‰ â€”â€” */
const STATUS = {
  ENABLED:   {cls:'b-enabled',     text:'å¯ç”¨ä¸­',  icon:'ğŸŸ¢'},
  DRAFT:     {cls:'b-draft',       text:'è‰ç¨¿',    icon:'ğŸŸ¡'},
  PUBLISHING:{cls:'b-publishing',  text:'å‘å¸ƒä¸­',  icon:'ğŸ”µ'},
  PUBLISH_FAILED:{cls:'b-failed',  text:'å‘å¸ƒå¤±è´¥',icon:'ğŸ”´'}
};

/* ç¤ºä¾‹æ•°æ®ï¼šè¦†ç›–å››ç§çŠ¶æ€ */
let rows = [
  { code:'annotation_type', name:'æ ‡æ³¨ç±»å‹', desc:'ç”¨äºæ ‡æ³¨åŠŸèƒ½çš„ç±»å‹é…ç½®', date:'2025-10-15', status:'ENABLED' },
  { code:'label_template',  name:'æ ‡ç­¾æ¨¡æ¿', desc:'æ ‡æ³¨æ ‡ç­¾æ¨¡æ¿é›†',         date:'2025-10-12', status:'DRAFT' },
  { code:'review_flag',     name:'å‘å¸ƒæµç¨‹', desc:'å‘å¸ƒå®¡æ‰¹ä¸­çš„é…ç½®',         date:'2025-10-14', status:'PUBLISHING' },
  { code:'new_rules',       name:'æ–°è§„åˆ™',   desc:'æœ€è¿‘ä¸€æ¬¡å‘å¸ƒå¤±è´¥ç¤ºä¾‹',     date:'2025-10-16', status:'PUBLISH_FAILED' }
];

const $  = s => document.querySelector(s);
const byId = id => document.getElementById(id);

/* â€”â€” æ¨¡æ€å¼€å…³ â€”â€” */
const openM = id => byId('modal-'+id).classList.add('show');
const closeM = id => byId('modal-'+id).classList.remove('show');
['log','del','add'].forEach(id=>{
  byId('modal-'+id).addEventListener('click',e=>{
    if(e.target.id==='modal-'+id) closeM(id);
  });
});
document.querySelectorAll('[data-close="log"]').forEach(el=>el.onclick=()=>closeM('log'));
document.querySelectorAll('[data-close="del"]').forEach(el=>el.onclick=()=>closeM('del'));
document.querySelectorAll('[data-close="add"]').forEach(el=>el.onclick=()=>closeM('add'));

/* â€”â€” é¡µé¢åˆ‡æ¢ â€”â€” */
const show = id => {
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  byId(id).classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
};
byId('btn-back').onclick   = ()=>show('page-list');
byId('btn-add-item').onclick = ()=>openM('add');

/* â€”â€” å­—å…¸å…ƒä¿¡æ¯ç¼–è¾‘ â€”â€” */
let currentDictCode = null; // å½“å‰æ­£åœ¨ç¼–è¾‘çš„å­—å…¸ç¼–ç 

function fillMetaForm(row) {
  byId('edit-code').value = row?.code || '';
  byId('edit-name').value = row?.name || '';
  byId('edit-desc').value = row?.desc || '';
  currentDictCode = row ? row.code : null;
  byId('dict-title').innerHTML =
    `å­—å…¸é¡¹ç®¡ç† Â· ${row?.name || 'æ–°å­—å…¸'}ï¼ˆ${row?.code || 'æœªè®¾ç½®ç¼–ç '}ï¼‰`;
}
function saveMetaForm() {
  const code = byId('edit-code').value.trim();
  const name = byId('edit-name').value.trim();
  const desc = byId('edit-desc').value.trim();
  if(!code || !name){ alert('â€œå­—å…¸ç¼–ç â€å’Œâ€œåç§°â€ä¸ºå¿…å¡«é¡¹'); return; }
  // ç¼–ç å”¯ä¸€æ ¡éªŒ
  const exists = rows.some(r => r.code===code && r.code!==currentDictCode);
  if(exists){ alert('å­—å…¸ç¼–ç å·²å­˜åœ¨ï¼Œè¯·æ›´æ¢'); return; }
  const now = new Date().toISOString().slice(0,10);
  if(currentDictCode===null){
    rows.unshift({code,name,desc,date:now,status:'DRAFT'});
  }else{
    rows = rows.map(r=> r.code===currentDictCode ? {...r, code,name,desc} : r);
  }
  render();
  const row = rows.find(r=>r.code===code);
  fillMetaForm(row);
  alert('å·²ä¿å­˜');
}
byId('btn-save-dict').onclick = saveMetaForm;

/* åˆ—è¡¨é¡µâ€œåˆ›å»ºå­—å…¸â€â†’ è¿›å…¥é¡¹é¡µå¹¶æ¸…ç©ºè¡¨å• */
byId('btn-create').onclick = ()=>{
  show('page-item');
  fillMetaForm(null);
};

/* â€”â€” æ¸²æŸ“åˆ—è¡¨ â€”â€” */
const tbody = byId('dict-table').querySelector('tbody');
let pendingDeleteCode = null;

function badge(status){
  const s = STATUS[status] || STATUS.DRAFT;
  return `<span class="badge ${s.cls}" title="${status}">${s.icon} ${s.text}</span>`;
}

function render(){
  tbody.innerHTML = '';
  rows.forEach(r=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${r.code}</td>
      <td>${r.name}</td>
      <td>${r.desc}</td>
      <td>${r.date}</td>
      <td>${badge(r.status)}</td>
      <td>
        <span class="link" data-log="${r.code}">æŸ¥çœ‹æ—¥å¿—</span> |
        <span class="link" data-edit="${r.code}">ç¼–è¾‘</span> |
        <span class="link" data-del="${r.code}">åˆ é™¤</span>
      </td>
    `;
    tbody.appendChild(tr);
  });

  // æ“ä½œäº‹ä»¶
  document.querySelectorAll('[data-log]').forEach(a=>{
    a.onclick = ()=>{
      const code = a.getAttribute('data-log');
      byId('log-content').innerHTML = `
        <div>æ“ä½œæ—¥å¿—ï¼ˆ${code}ï¼‰</div>
        <div>Â· ${new Date().toLocaleString()} æŸ¥çœ‹è¯¦æƒ…</div>
      `;
      openM('log');
    };
  });
  document.querySelectorAll('[data-edit]').forEach(a=>{
    a.onclick = ()=>{
      const code = a.getAttribute('data-edit');
      const row = rows.find(r=>r.code===code);
      show('page-item');
      fillMetaForm(row);
    };
  });
  document.querySelectorAll('[data-del]').forEach(a=>{
    a.onclick = ()=>{
      pendingDeleteCode = a.getAttribute('data-del');
      openM('del');
    };
  });
}
render();

/* åˆ é™¤ï¼šæ¼”ç¤ºä¸ºä»åˆ—è¡¨ç§»é™¤ï¼›å¦‚éœ€é€»è¾‘åˆ é™¤å¯ä»¥æ”¹ä¸ºè®¾ç½®çŠ¶æ€ */
byId('confirm-delete').onclick = ()=>{
  if(pendingDeleteCode){
    rows = rows.filter(r=>r.code!==pendingDeleteCode);
    pendingDeleteCode = null;
    render();
  }
  closeM('del');
};
</script>
</body>
</html>


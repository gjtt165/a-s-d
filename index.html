<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>äº‘ç«¯èµ„æºç®¡ç†ç³»ç»Ÿ Â· å­—å…¸ç®¡ç†åŸå‹</title>
<style>
  :root{
    --primary:#0066ff;--bg:#f5f7fa;--card:#fff;--muted:#666;--border:#e9edf2;
    --radius:8px;--shadow:0 1px 4px rgba(0,0,0,.08);
    --green:#22c55e;--yellow:#f59e0b;--blue:#3b82f6;--red:#ef4444;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);font:14px/1.6,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial}
  .header{background:var(--primary);color:#fff;padding:12px 20px;font-size:18px}
  .layout{display:flex;min-height:100dvh}
  .sidebar{width:240px;background:#f8f9fb;border-right:1px solid var(--border);padding:14px}
  .side-title{color:#999;font-size:12px;margin:6px 10px}
  .menu a{display:flex;gap:8px;align-items:center;color:#334;text-decoration:none;padding:9px 12px;border-radius:6px;margin:4px 0}
  .menu a.active{background:#e6f0ff;color:var(--primary);font-weight:600}
  .menu .dot{width:8px;height:8px;border-radius:50%;background:var(--primary)}
  .main{flex:1;padding:18px}

  .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;position:relative}
  .card-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;gap:12px}
  .hint{color:#8a8f98;font-size:12px}

  .toolbar{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:8px;flex-wrap:wrap}
  .toolbar-left,.toolbar-right{display:flex;align-items:center;gap:8px}
  .input{border:1px solid var(--border);border-radius:6px;padding:6px 10px;min-width:120px;background:#fff}
  table{width:100%;border-collapse:collapse;margin-top:8px}
  th,td{border-bottom:1px solid var(--border);padding:10px;text-align:left}
  th{background:#fafbfc}
  .link{color:var(--primary);cursor:pointer}
  .note{border:1px dashed var(--border);padding:6px 8px;border-radius:6px;color:#596}

  .btn{border:0;border-radius:6px;background:var(--primary);color:#fff;padding:8px 14px;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
  .btn:hover{filter:brightness(.96)}
  .btn.gray{background:#eef2f6;color:#223}
  .btn .icon-plus svg path{fill:#fff;stroke:#fff}
  .btn .icon-left svg path{stroke:#222}

  .badge{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:999px;font-weight:600}
  .b-enabled{color:var(--green);background:rgba(34,197,94,.12)}
  .b-draft{color:var(--yellow);background:rgba(245,158,11,.16)}
  .b-publishing{color:var(--blue);background:rgba(59,130,246,.16)}
  .b-failed{color:var(--red);background:rgba(239,68,68,.14)}

  .page{display:none}
  .page.active{display:block}

  .meta-form{display:grid;grid-template-columns:160px 1fr;gap:10px 12px}
  .meta-form label{color:#555;align-self:center}
  .meta-form .row{display:contents}

  @media (max-width: 960px){
    .sidebar{display:none}
    .main{padding:12px}
  }
</style>
</head>
<body>
  <div class="header">äº‘ç«¯èµ„æºç®¡ç†ç³»ç»Ÿ Â· å­—å…¸ç®¡ç†åŸå‹</div>

  <div class="layout">
    <aside class="sidebar">
      <div class="side-title">å¯¼èˆª</div>
      <nav class="menu">
        <a><span class="dot"></span>ä¸šåŠ¡ç³»ç»Ÿç®¡ç†</a>
        <a><span class="dot"></span>é›†ç¾¤ç®¡ç†</a>
        <a><span class="dot"></span>ä»»åŠ¡ç®¡ç†</a>
        <a class="active"><span class="dot"></span>å­—å…¸ç®¡ç†</a>
        <a><span class="dot"></span>å¹³å°é•œåƒ</a>
        <a><span class="dot"></span>ç›‘æ§å‘Šè­¦</a>
        <a><span class="dot"></span>APIé…ç½®</a>
      </nav>
    </aside>

    <main class="main">
      <!-- =================== é¡µ 1ï¼šå­—å…¸åˆ—è¡¨ =================== -->
      <section id="page-list" class="page active">
        <div class="card">
          <div class="toolbar">
            <div class="toolbar-left">
              <button class="btn" id="btn-create">
                <span class="icon-plus"><svg viewBox="0 0 16 16" width="16" height="16"><path d="M8 3v10M3 8h10" stroke="#fff" stroke-width="2" stroke-linecap="round" fill="#fff"/></svg></span>
                åˆ›å»ºå­—å…¸
              </button>
              <input id="search" class="input" placeholder="æœç´¢ï¼šåç§°/ç¼–ç " />
            </div>
            <div class="toolbar-right">
              <span class="note">çŠ¶æ€ä»…å±•ç¤ºï¼šğŸŸ¢å¯ç”¨ä¸­ / ğŸŸ¡è‰ç¨¿ / ğŸ”µå‘å¸ƒä¸­ / ğŸ”´å‘å¸ƒå¤±è´¥</span>
            </div>
          </div>

          <table id="dict-table">
            <thead>
            <tr>
              <th>å­—å…¸ç¼–ç </th><th>åç§°</th><th>æè¿°</th><th>åˆ›å»ºæ—¶é—´</th><th>çŠ¶æ€</th><th style="width:220px">æ“ä½œ</th>
            </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- =================== é¡µ 2ï¼šå­—å…¸é¡¹ç¼–è¾‘ =================== -->
      <section id="page-item" class="page">
        <div class="card" style="margin-bottom:12px">
          <div class="card-head">
            <div style="display:flex;align-items:center;gap:10px">
              <button class="btn gray" id="btn-back">
                <span class="icon-left"><svg viewBox="0 0 16 16" width="16" height="16"><path d="M9.5 3L4.5 8l5 5" fill="none" stroke="#222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></span>
                è¿”å›
              </button>
              <span class="hint">å¯ç¼–è¾‘å­—å…¸å…ƒä¿¡æ¯ï¼Œä¿å­˜ååŒæ­¥åˆ°åˆ—è¡¨ä¸æ ‡é¢˜</span>
            </div>
            <button class="btn" id="btn-save-dict">
              <svg viewBox="0 0 16 16" width="16" height="16" style="margin-right:6px">
                <path d="M3 8l3 3 7-7" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
              </svg>ä¿å­˜
            </button>
          </div>

          <div class="meta-form">
            <div class="row"><label for="edit-code">å­—å…¸ç¼–ç </label><input id="edit-code" class="input" value=""></div>
            <div class="row"><label for="edit-name">åç§°</label><input id="edit-name" class="input" value=""></div>
            <div class="row"><label for="edit-desc">æè¿°</label><input id="edit-desc" class="input" value=""></div>
          </div>
        </div>

        <div class="card">
          <div class="card-head">
            <h3 id="dict-title" style="margin:0">å­—å…¸é¡¹ç®¡ç† Â· ï¼ˆæœªè®¾ç½®ï¼‰</h3>
            <button class="btn" id="btn-add-item">
              <span class="icon-plus"><svg viewBox="0 0 16 16" width="16" height="16"><path d="M8 3v10M3 8h10" stroke="#fff" stroke-width="2" stroke-linecap="round" fill="#fff"/></svg></span>
              æ–°å¢å­—å…¸é¡¹
            </button>
          </div>
          <table id="dict-item-table">
            <thead><tr><th>æ’åº</th><th>Label</th><th>Value</th><th>å¤‡æ³¨</th><th>æ“ä½œ</th></tr></thead>
            <tbody id="dict-item-body"></tbody>
          </table>
        </div>
      </section>
    </main>
  </div>

<script>
/* ========== çŠ¶æ€ï¼ˆåˆ—è¡¨é¡µå±•ç¤ºå¾½ç« ï¼‰ ========== */
const STATUS = {
  ENABLED:{cls:'b-enabled',text:'å¯ç”¨ä¸­',icon:'ğŸŸ¢'},
  DRAFT:{cls:'b-draft',text:'è‰ç¨¿',icon:'ğŸŸ¡'},
  PUBLISHING:{cls:'b-publishing',text:'å‘å¸ƒä¸­',icon:'ğŸ”µ'},
  PUBLISH_FAILED:{cls:'b-failed',text:'å‘å¸ƒå¤±è´¥',icon:'ğŸ”´'}
};

/* ========== æ¨¡æ‹Ÿæ•°æ®ï¼šåˆ—è¡¨ ========== */
let dictRows = [
  { code:'annotation_type', name:'æ ‡æ³¨ç±»å‹', desc:'ç”¨äºæ ‡æ³¨åŠŸèƒ½çš„ç±»å‹é…ç½®', date:'2025-10-15', status:'ENABLED',
    items:[ {label:'æ–‡å­—',value:'text',remark:'é»˜è®¤ç±»å‹'}, {label:'å›¾ç‰‡',value:'image',remark:'2024æ–°å¢'}, {label:'éŸ³é¢‘',value:'audio',remark:'è¿ç»´æ–°å¢'} ]},
  { code:'label_template',  name:'æ ‡ç­¾æ¨¡æ¿', desc:'æ ‡æ³¨æ ‡ç­¾æ¨¡æ¿é›†',         date:'2025-10-12', status:'DRAFT',
    items:[ {label:'åˆæ ¼',value:'ok',remark:''} ] },
  { code:'review_flow',     name:'å‘å¸ƒæµç¨‹', desc:'å‘å¸ƒå®¡æ‰¹ä¸­çš„é…ç½®',         date:'2025-10-14', status:'PUBLISHING',
    items:[ ] },
  { code:'new_rules',       name:'æ–°è§„åˆ™',   desc:'æœ€è¿‘ä¸€æ¬¡å‘å¸ƒå¤±è´¥ç¤ºä¾‹',     date:'2025-10-16', status:'PUBLISH_FAILED',
    items:[ ] }
];

/* DOM & å·¥å…· */
const $ = s => document.querySelector(s);
const byId = id => document.getElementById(id);
function show(id){ document.querySelectorAll('.page').forEach(p=>p.classList.remove('active')); byId(id).classList.add('active'); window.scrollTo({top:0,behavior:'smooth'}); }

/* ========== ç¬¬ä¸€é¡µï¼šæ¸²æŸ“åˆ—è¡¨ ========== */
const tbodyList = byId('dict-table').querySelector('tbody');
function badge(status){ const s=STATUS[status]||STATUS.DRAFT; return `<span class="badge ${s.cls}">${s.icon} ${s.text}</span>`; }
function renderList(filter=''){
  tbodyList.innerHTML='';
  dictRows
    .filter(r=>!filter || r.code.includes(filter)||r.name.includes(filter))
    .forEach(r=>{
      const tr=document.createElement('tr');
      tr.innerHTML=`
        <td>${r.code}</td>
        <td>${r.name}</td>
        <td>${r.desc}</td>
        <td>${r.date}</td>
        <td>${badge(r.status)}</td>
        <td>
          <span class="link" data-log="${r.code}">æŸ¥çœ‹æ—¥å¿—</span> |
          <span class="link" data-edit="${r.code}">ç¼–è¾‘</span> |
          <span class="link" data-del="${r.code}">åˆ é™¤</span>
        </td>`;
      tbodyList.appendChild(tr);
    });

  document.querySelectorAll('[data-log]').forEach(a=>a.onclick=()=>alert('ï¼ˆç¤ºä¾‹ï¼‰æ‰“å¼€æ—¥å¿—ï¼š'+a.dataset.log));
  document.querySelectorAll('[data-edit]').forEach(a=>a.onclick=()=>openEditor(a.dataset.edit));
  document.querySelectorAll('[data-del]').forEach(a=>a.onclick=()=>{
    const code=a.dataset.del;
    if(confirm('ç¡®è®¤åˆ é™¤å­—å…¸ï¼š'+code+' ï¼Ÿ')){
      dictRows=dictRows.filter(r=>r.code!==code);
      renderList(byId('search').value.trim());
    }
  });
}
renderList();
byId('search').addEventListener('input',e=>renderList(e.target.value.trim()));

/* åˆ›å»ºå­—å…¸ï¼šæ‰“å¼€ç©ºç™½ç¼–è¾‘é¡µ */
byId('btn-create').onclick=()=>openEditor(null);

/* ========== ç¬¬äºŒé¡µï¼šç¼–è¾‘é¡µ ========== */
let currentCode=null;
function fillMetaForm(dict){
  byId('edit-code').value=dict.code||'';
  byId('edit-name').value=dict.name||'';
  byId('edit-desc').value=dict.desc||'';
  byId('dict-title').textContent=`å­—å…¸é¡¹ç®¡ç† Â· ${dict.name||'ï¼ˆæœªå‘½åï¼‰'}ï¼ˆ${dict.code||'æœªè®¾ç½®'}ï¼‰`;
}
function renderItems(items){
  const tbody=byId('dict-item-body'); tbody.innerHTML='';
  (items||[]).forEach((it,idx)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`
      <td>${idx+1}</td>
      <td><input class="input" value="${it.label||''}" placeholder="Label"></td>
      <td><input class="input" value="${it.value||''}" placeholder="Value"></td>
      <td><input class="input" value="${it.remark||''}" placeholder="å¤‡æ³¨"></td>
      <td><span class="link" onclick="deleteRow(this)">åˆ é™¤</span></td>`;
    tbody.appendChild(tr);
  });
}
function openEditor(code){
  const dict= dictRows.find(r=>r.code===code) || {code:'',name:'',desc:'',items:[]};
  currentCode = dict.code || null;
  fillMetaForm(dict);
  renderItems(dict.items);
  show('page-item');
}
byId('btn-back').onclick=()=>show('page-list');

function updateRowNumbers(){ document.querySelectorAll('#dict-item-body tr').forEach((tr,i)=>tr.children[0].textContent=i+1); }
function deleteRow(el){ el.closest('tr').remove(); updateRowNumbers(); }
window.deleteRow=deleteRow;

byId('btn-add-item').onclick=()=>{
  const tbody=byId('dict-item-body');
  const tr=document.createElement('tr');
  tr.innerHTML=`
    <td></td>
    <td><input class="input" placeholder="Label"></td>
    <td><input class="input" placeholder="Value"></td>
    <td><input class="input" placeholder="å¤‡æ³¨"></td>
    <td><span class="link" onclick="deleteRow(this)">åˆ é™¤</span></td>`;
  tbody.appendChild(tr); updateRowNumbers();
};

/* ä¿å­˜ï¼šå…ƒä¿¡æ¯ + å­—å…¸é¡¹ */
byId('btn-save-dict').onclick=()=>{
  const info={
    code:byId('edit-code').value.trim(),
    name:byId('edit-name').value.trim(),
    desc:byId('edit-desc').value.trim()
  };
  if(!info.code||!info.name){ alert('â€œå­—å…¸ç¼–ç â€â€œåç§°â€ä¸ºå¿…å¡«'); return; }

  const items=[];
  document.querySelectorAll('#dict-item-body tr').forEach(tr=>{
    const inputs=tr.querySelectorAll('input');
    items.push({ label:inputs[0].value.trim(), value:inputs[1].value.trim(), remark:inputs[2].value.trim() });
  });

  const existsIdx=dictRows.findIndex(r=>r.code===currentCode);
  const dup=dictRows.some(r=>r.code===info.code && info.code!==currentCode);
  if(dup){ alert('å­—å…¸ç¼–ç å·²å­˜åœ¨'); return; }

  const now=new Date().toISOString().slice(0,10);
  if(existsIdx>=0){
    dictRows[existsIdx]={...dictRows[existsIdx], ...info, items};
  }else{
    dictRows.unshift({...info, date:now, status:'DRAFT', items});
  }

  console.log('ä¿å­˜æ•°æ®ï¼š', {...info, items});
  alert('å·²ä¿å­˜ï¼ï¼ˆæ§åˆ¶å°æŸ¥çœ‹ JSONï¼‰');
  renderList(byId('search').value.trim());
  show('page-list');
};
</script>
</body>
</html>

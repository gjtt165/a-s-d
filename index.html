<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bitahub è¿ç»´å¹³å° Â· å­—å…¸ç®¡ç†åŸå‹ï¼ˆçŠ¶æ€å¯äº¤äº’ç‰ˆï¼‰</title>
<style>
  :root{
    --primary:#0066ff;--bg:#f5f7fa;--card:#fff;--muted:#666;--border:#e9edf2;
    --radius:8px;--shadow:0 1px 4px rgba(0,0,0,.08);
    --green:#28a745;--gray:#a0a5ac;--yellow:#f5b841;--blue:#3b82f6;--red:#dc3545;
  }
  *{box-sizing:border-box} body{margin:0;background:var(--bg);font:14px/1.6 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial}
  .header{background:var(--primary);color:#fff;padding:12px 20px;font-size:18px}
  .layout{display:flex;min-height:100dvh}
  .sidebar{width:240px;background:#f8f9fb;border-right:1px solid var(--border);padding:14px}
  .side-title{color:#999;font-size:12px;margin:6px 10px}
  .menu a{display:flex;gap:8px;align-items:center;color:#334;text-decoration:none;padding:9px 12px;border-radius:6px;margin:4px 0}
  .menu a.active{background:#e6f0ff;color:var(--primary);font-weight:600}
  .menu .dot{width:8px;height:8px;border-radius:50%;background:var(--primary)}
  .main{flex:1;padding:18px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
  .toolbar{display:flex;gap:10px;justify-content:space-between;align-items:center;margin-bottom:8px}
  .btn{border:0;border-radius:6px;background:var(--primary);color:#fff;padding:8px 14px;cursor:pointer}
  .btn.gray{background:#eef2f6;color:#223}
  .input{border:1px solid var(--border);border-radius:6px;padding:8px 10px;min-width:260px;background:#fff}
  table{width:100%;border-collapse:collapse;margin-top:8px}
  th,td{border-bottom:1px solid var(--border);padding:10px;text-align:left;vertical-align:middle}
  th{background:#fafbfc}
  .status{display:inline-flex;align-items:center;gap:8px;padding:4px 8px;border-radius:999px;font-weight:600}
  .s-enabled{color:var(--green);background:rgba(40,167,69,.12)}
  .s-disabled{color:var(--gray);background:rgba(160,165,172,.18)}
  .s-draft{color:var(--yellow);background:rgba(245,184,65,.18)}
  .s-pending{color:var(--blue);background:rgba(59,130,246,.15)}
  .s-deleted{color:var(--red);background:rgba(220,53,69,.12)}
  .link{color:var(--primary);cursor:pointer}
  .page{display:none}.page.active{display:block}
  .dropdown{position:relative;display:inline-block}
  .drop-btn{border:1px solid var(--border);background:#fff;border-radius:6px;padding:6px 10px;cursor:pointer}
  .drop-menu{display:none;position:absolute;right:0;top:32px;background:#fff;border:1px solid var(--border);border-radius:8px;min-width:160px;box-shadow:0 8px 24px rgba(0,0,0,.12);z-index:10;overflow:hidden}
  .drop-menu button{display:block;width:100%;text-align:left;background:#fff;border:0;padding:10px 12px;cursor:pointer}
  .drop-menu button:hover{background:#f5f7fa}
  .drop-menu.show{display:block}

  /* modal */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;place-items:center;padding:16px;z-index:20}
  .modal.show{display:grid}
  .dialog{background:#fff;border-radius:10px;min-width:360px;max-width:560px;border:1px solid var(--border);box-shadow:0 10px 30px rgba(0,0,0,.2)}
  .dialog header{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:600}
  .dialog main{padding:14px 16px;color:#334}
  .dialog footer{padding:12px 16px;border-top:1px solid var(--border);display:flex;gap:8px;justify-content:flex-end}
</style>
</head>
<body>
  <div class="header">äº‘ç«¯èµ„æºç®¡ç†ç³»ç»Ÿ Â· å­—å…¸ç®¡ç†åŸå‹ï¼ˆçŠ¶æ€å¯äº¤äº’ï¼‰</div>
  <div class="layout">
    <!-- å·¦ä¾§å¯¼èˆª -->
    <aside class="sidebar">
      <div class="side-title">å¯¼èˆª</div>
      <nav class="menu">
        <a><span class="dot"></span>ä¸šåŠ¡ç³»ç»Ÿç®¡ç†</a>
        <a><span class="dot"></span>é›†ç¾¤ç®¡ç†</a>
        <a><span class="dot"></span>ä»»åŠ¡ç®¡ç†</a>
        <a id="menu-dict" class="active"><span class="dot"></span>å­—å…¸ç®¡ç†</a>
        <a><span class="dot"></span>å¹³å°é•œåƒ</a>
        <a><span class="dot"></span>ç›‘æ§å‘Šè­¦</a>
        <a><span class="dot"></span>APIé…ç½®</a>
      </nav>
    </aside>

    <!-- ä¸»å†…å®¹ -->
    <main class="main">
      <!-- å­—å…¸åˆ—è¡¨é¡µ -->
      <section id="page-list" class="page active">
        <div class="card">
          <div class="toolbar">
            <div style="display:flex;gap:8px;align-items:center">
              <button class="btn" id="btn-create">â• åˆ›å»ºå­—å…¸</button>
              <input class="input" placeholder="æœç´¢ï¼šåç§°/ç¼–ç " />
            </div>
            <span style="border:1px dashed var(--border);padding:6px 8px;border-radius:6px;color:#596">ä¸‹æ‹‰èœå•å¯åˆ‡æ¢çŠ¶æ€ï¼›ä¿ç•™ æŸ¥çœ‹æ—¥å¿— / ç¼–è¾‘ / åˆ é™¤</span>
          </div>

          <table id="dict-table">
            <thead>
              <tr><th>å­—å…¸ç¼–ç </th><th>åç§°</th><th>æè¿°</th><th>åˆ›å»ºæ—¶é—´</th><th>çŠ¶æ€</th><th style="width:280px">æ“ä½œ</th></tr>
            </thead>
            <tbody>
              <!-- è¡Œæ¸²æŸ“ç”± JS æ³¨å…¥ -->
            </tbody>
          </table>

          <div style="margin-top:10px;color:#888">çŠ¶æ€å«ä¹‰ï¼šğŸŸ¢å¯ç”¨ä¸­/âšªåœç”¨ä¸­/ğŸŸ¡è‰ç¨¿/ğŸ”µå®¡æ ¸ä¸­/ğŸ”´å·²åˆ é™¤</div>
        </div>
      </section>

      <!-- å­—å…¸é¡¹ç®¡ç†é¡µ -->
      <section id="page-item" class="page">
        <div class="card">
          <div class="toolbar">
            <a href="javascript:void 0" id="btn-back">â† è¿”å›å­—å…¸åˆ—è¡¨</a>
            <button class="btn" id="btn-add-item">â• æ–°å¢å­—å…¸é¡¹</button>
          </div>
          <h3 style="margin:6px 2px 10px">å­—å…¸é¡¹ç®¡ç† Â· æ ‡æ³¨ç±»å‹ï¼ˆannotation_typeï¼‰</h3>
          <table>
            <thead><tr><th>æ’åº</th><th>Label</th><th>Value</th><th>çŠ¶æ€</th><th>å¤‡æ³¨</th><th>æ“ä½œ</th></tr></thead>
            <tbody>
              <tr><td>1</td><td>æ–‡å­—</td><td>text</td><td>å¯ç”¨</td><td>é»˜è®¤ç±»å‹</td><td><span class="link" data-open="del">åˆ é™¤</span></td></tr>
              <tr><td>2</td><td>å›¾ç‰‡</td><td>image</td><td>å¯ç”¨</td><td>2024æ–°å¢</td><td><span class="link" data-open="del">åˆ é™¤</span></td></tr>
              <tr><td>3</td><td>éŸ³é¢‘</td><td>audio</td><td>å¯ç”¨</td><td>è¿ç»´æ–°å¢</td><td><span class="link" data-open="del">åˆ é™¤</span></td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>
  </div>

  <!-- å¼¹çª—ï¼šæŸ¥çœ‹æ—¥å¿— -->
  <div id="modal-log" class="modal" aria-hidden="true">
    <div class="dialog" role="dialog" aria-modal="true">
      <header>æ“ä½œæ—¥å¿—</header>
      <main id="log-content">
        <div>2025-10-15 åˆ›å»ºå­—å…¸ <b>annotation_type</b></div>
        <div>2025-10-16 æ–°å¢é¡¹ <b>audio</b></div>
      </main>
      <footer>
        <button class="btn gray" data-close="log">å…³é—­</button>
      </footer>
    </div>
  </div>

  <!-- å¼¹çª—ï¼šåˆ é™¤ç¡®è®¤ï¼ˆåˆ—è¡¨é¡µ/é¡¹é¡µå…±ç”¨ï¼‰ -->
  <div id="modal-del" class="modal" aria-hidden="true">
    <div class="dialog" role="dialog" aria-modal="true">
      <header>ç¡®è®¤åˆ é™¤</header>
      <main>æ­¤æ“ä½œä¸å¯æ¢å¤ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ</main>
      <footer>
        <button class="btn gray" data-close="del">å–æ¶ˆ</button>
        <button class="btn" id="confirm-delete">ç¡®è®¤åˆ é™¤</button>
      </footer>
    </div>
  </div>

  <!-- å¼¹çª—ï¼šæ–°å¢å­—å…¸é¡¹ -->
  <div id="modal-add" class="modal" aria-hidden="true">
    <div class="dialog" role="dialog" aria-modal="true">
      <header>æ–°å¢å­—å…¸é¡¹</header>
      <main>
        <div style="display:grid;gap:10px">
          <label>Labelï¼š<input class="input" placeholder="å¦‚ï¼šéŸ³é¢‘"></label>
          <label>Valueï¼š<input class="input" placeholder="å¦‚ï¼šaudio"></label>
          <label>å¤‡æ³¨ï¼š<input class="input" placeholder="å¯é€‰"></label>
        </div>
      </main>
      <footer>
        <button class="btn gray" data-close="add">å–æ¶ˆ</button>
        <button class="btn" data-close="add">ä¿å­˜</button>
      </footer>
    </div>
  </div>

<script>
/** â€”â€” æ•°æ®ä¸å·¥å…· â€”â€” **/
const STATUS = {
  ENABLED:  { cls: 's-enabled',  text: 'å¯ç”¨ä¸­',  color:'ğŸŸ¢' },
  DISABLED: { cls: 's-disabled', text: 'åœç”¨ä¸­',  color:'âšª' },
  DRAFT:    { cls: 's-draft',    text: 'è‰ç¨¿',    color:'ğŸŸ¡' },
  PENDING_REVIEW:{cls:'s-pending',text:'å®¡æ ¸ä¸­', color:'ğŸ”µ'},
  DELETED:  { cls: 's-deleted',  text: 'å·²åˆ é™¤',  color:'ğŸ”´' }
};
// åˆå§‹ç¤ºä¾‹æ•°æ®ï¼šè¦†ç›–ä¸åŒçŠ¶æ€
let rows = [
  { code:'annotation_type', name:'æ ‡æ³¨ç±»å‹', desc:'ç”¨äºæ ‡æ³¨åŠŸèƒ½çš„ç±»å‹é…ç½®', date:'2025-10-15', status:'ENABLED', logs:['åˆ›å»º','æ–°å¢é¡¹ audio'] },
  { code:'file_type',       name:'æ–‡ä»¶ç±»å‹', desc:'ä¸Šä¼ æ–‡ä»¶ç±»å‹é™åˆ¶',       date:'2025-09-20', status:'DISABLED', logs:['åˆ›å»º','åœç”¨'] },
  { code:'label_template',  name:'æ ‡ç­¾æ¨¡æ¿', desc:'æ ‡æ³¨æ ‡ç­¾æ¨¡æ¿é›†',         date:'2025-08-10', status:'DRAFT', logs:['åˆ›å»º','è‰ç¨¿ä¿å­˜'] },
  { code:'review_flag',     name:'å®¡æ ¸æ ‡è®°', desc:'æ•æ„Ÿé…ç½®éœ€å®¡æ ¸',         date:'2025-10-10', status:'PENDING_REVIEW', logs:['æäº¤å®¡æ ¸'] },
  { code:'old_dict',        name:'å†å²å­—å…¸', desc:'å·²é€»è¾‘åˆ é™¤çš„æ—§é…ç½®',     date:'2024-12-01', status:'DELETED', logs:['åˆ é™¤'] },
];

const byId = id => document.getElementById(id);
const open = id => byId('modal-'+id).classList.add('show');
const closeM = id => byId('modal-'+id).classList.remove('show');
['log','del','add'].forEach(id=>{
  byId('modal-'+id).addEventListener('click',e=>{
    if(e.target.id==='modal-'+id) closeM(id);
  });
});
document.querySelectorAll('[data-close="log"]').forEach(el=>el.onclick=()=>closeM('log'));
document.querySelectorAll('[data-close="del"]').forEach(el=>el.onclick=()=>closeM('del'));
document.querySelectorAll('[data-close="add"]').forEach(el=>el.onclick=()=>closeM('add'));

const show = id => {
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  byId(id).classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
};
byId('btn-create').onclick = ()=>show('page-item');
byId('btn-back').onclick = ()=>show('page-list');
byId('btn-add-item').onclick = ()=>open('add');

/** â€”â€” æ¸²æŸ“è¡¨æ ¼ â€”â€” **/
const tbody = document.querySelector('#dict-table tbody');
let pendingDeleteCode = null;

function statusBadge(s){
  const meta = STATUS[s];
  return `<span class="status ${meta.cls}" title="${s}">${meta.color} ${meta.text}</span>`;
}

function opsDropdown(row){
  // æ ¹æ®å½“å‰çŠ¶æ€ç”Ÿæˆå¯æ“ä½œé¡¹
  const opsByStatus = {
    ENABLED: ['åœç”¨','åˆ é™¤','æŸ¥çœ‹æ—¥å¿—','ç¼–è¾‘'],
    DISABLED:['å¯ç”¨','åˆ é™¤','æŸ¥çœ‹æ—¥å¿—','ç¼–è¾‘'],
    DRAFT:   ['æäº¤å®¡æ ¸','åˆ é™¤','æŸ¥çœ‹æ—¥å¿—','ç¼–è¾‘'],
    PENDING_REVIEW:['å®¡æ ¸é€šè¿‡','é©³å›','æŸ¥çœ‹æ—¥å¿—','ç¼–è¾‘'],
    DELETED: ['æ¢å¤','æŸ¥çœ‹æ—¥å¿—'] // åˆ é™¤åä»…å¯æ¢å¤ä¸çœ‹æ—¥å¿—
  };
  const items = opsByStatus[row.status] || [];
  const btnId = `drop-${row.code}`;
  let menu = items.map(op=>`<button data-op="${op}" data-code="${row.code}">${op}</button>`).join('');
  return `
    <div class="dropdown">
      <button class="drop-btn" data-drop="${btnId}">çŠ¶æ€æ“ä½œ â–¾</button>
      <div class="drop-menu" id="${btnId}">
        ${menu}
      </div>
    </div>
  `;
}

function render(){
  tbody.innerHTML = '';
  rows.forEach(row=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${row.code}</td>
      <td>${row.name}</td>
      <td>${row.desc}</td>
      <td>${row.date}</td>
      <td>${statusBadge(row.status)}</td>
      <td>
        ${opsDropdown(row)}
        &nbsp;&nbsp;
        <span class="link" data-log="${row.code}">æŸ¥çœ‹æ—¥å¿—</span> |
        <span class="link" data-edit="${row.code}">ç¼–è¾‘</span> |
        <span class="link" data-del="${row.code}">åˆ é™¤</span>
      </td>
    `;
    tbody.appendChild(tr);
  });
  bindRowEvents();
}

function setStatus(code, newStatus){
  rows = rows.map(r => r.code===code ? {...r, status:newStatus} : r);
  render();
}

function bindRowEvents(){
  // æ‰“å¼€/å…³é—­ä¸‹æ‹‰
  document.querySelectorAll('[data-drop]').forEach(btn=>{
    btn.onclick = (e)=>{
      const id = btn.getAttribute('data-drop');
      // å…ˆæ”¶èµ·å…¶ä»–
      document.querySelectorAll('.drop-menu').forEach(m=>m.classList.remove('show'));
      byId(id).classList.toggle('show');
      e.stopPropagation();
    };
  });
  // ç‚¹å‡»é¡µé¢å…¶ä»–å¤„æ”¶èµ·
  document.addEventListener('click', ()=> {
    document.querySelectorAll('.drop-menu').forEach(m=>m.classList.remove('show'));
  }, { once:true });

  // ä¸‹æ‹‰é¡¹æ“ä½œ
  document.querySelectorAll('.drop-menu button').forEach(b=>{
    b.onclick = ()=>{
      const op = b.getAttribute('data-op');
      const code = b.getAttribute('data-code');
      switch(op){
        case 'å¯ç”¨': setStatus(code,'ENABLED'); break;
        case 'åœç”¨': setStatus(code,'DISABLED'); break;
        case 'æäº¤å®¡æ ¸': setStatus(code,'PENDING_REVIEW'); break;
        case 'å®¡æ ¸é€šè¿‡': setStatus(code,'ENABLED'); break;
        case 'é©³å›': setStatus(code,'DRAFT'); break;
        case 'æ¢å¤': setStatus(code,'DISABLED'); break; // æ¢å¤åˆ°åœç”¨æ€ï¼Œé¿å…ç›´æ¥å¯ç”¨
        case 'åˆ é™¤':
          pendingDeleteCode = code; open('del'); break;
        case 'æŸ¥çœ‹æ—¥å¿—':
          byId('log-content').innerHTML = `
            <div>æœ€è¿‘æ“ä½œè®°å½•ï¼ˆ${code}ï¼‰ï¼š</div>
            <div>Â· ${new Date().toLocaleString()} æŸ¥çœ‹è¯¦æƒ…</div>
          `;
          open('log'); break;
        case 'ç¼–è¾‘':
          show('page-item'); break;
      }
    };
  });

  // åŸâ€œæŸ¥çœ‹æ—¥å¿—/ç¼–è¾‘/åˆ é™¤â€ä¿ç•™
  document.querySelectorAll('[data-log]').forEach(a=>{
    a.onclick = ()=>{
      const code = a.getAttribute('data-log');
      byId('log-content').innerHTML = `
        <div>æ“ä½œæ—¥å¿—ï¼ˆ${code}ï¼‰</div>
        <div>Â· 2025-10-15 åˆ›å»º</div>
        <div>Â· 2025-10-16 ä¿®æ”¹æè¿°</div>
      `;
      open('log');
    };
  });
  document.querySelectorAll('[data-edit]').forEach(a=>{
    a.onclick = ()=> show('page-item');
  });
  document.querySelectorAll('[data-del]').forEach(a=>{
    a.onclick = ()=>{
      pendingDeleteCode = a.getAttribute('data-del');
      open('del');
    };
  });
}

// ç¡®è®¤åˆ é™¤ = ç½®ä¸º DELETED
byId('confirm-delete').onclick = ()=>{
  if(pendingDeleteCode){
    setStatus(pendingDeleteCode,'DELETED');
    pendingDeleteCode = null;
  }
  closeM('del');
};

render();
</script>
</body>
</html>
